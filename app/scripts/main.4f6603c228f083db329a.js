(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,s,r,i,l=[],c=!0,o=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=r.call(n)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(e){o=!0,s=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(o)throw s}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return n(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function a(t,n){for(var a=0;a<n.length;a++){var s=n[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,(r=s.key,i=void 0,i=function(t,n){if("object"!==e(t)||null===t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var s=a.call(t,n||"default");if("object"!==e(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(r,"string"),"symbol"===e(i)?i:String(i)),s)}var r,i}var s={1:[["ё"],["1","!"],["2",'"'],["3","№"],["4",";"],["5","%"],["6",":"],["7","?"],["8","*"],["9","("],["0",")"],["-","_"],["=","+"],["Backspace"]],2:[["Tab"],["й"],["ц"],["у"],["к"],["е"],["н"],["г"],["ш"],["щ"],["з"],["х"],["ъ"],["\\","|"],["Del"]],3:[["Caps lock"],["ф"],["ы"],["в"],["а"],["п"],["р"],["о"],["л"],["д"],["ж"],["э"],["Enter"]],4:[["Shift"],["\\","|"],["я"],["ч"],["с"],["м"],["и"],["т"],["ь"],["б"],["ю"],[".",","],["inner_up"],["Shift"]],5:[["Ctrl"],["Win"],["Alt"],["space"],["Alt"],["Ctrl"],["inner_left"],["inner_down"],["inner_right"]]},r={1:[["`","~"],["1","!"],["2","@"],["3","#"],["4","$"],["5","%"],["6","^"],["7","&"],["8","*"],["9","("],["0",")"],["-","_"],["=","+"],["Backspace"]],2:[["Tab"],["q"],["w"],["e"],["r"],["t"],["y"],["u"],["i"],["o"],["p"],["[","{"],["]","}"],["\\","|"],["Del"]],3:[["Caps lock"],["a"],["s"],["d"],["f"],["g"],["h"],["j"],["k"],["l"],[";",":"],["'",'"'],["Enter"]],4:[["Shift"],["\\","|"],["z"],["x"],["c"],["v"],["b"],["n"],["m"],[",","<"],[".",">"],["/","?"],["inner_up"],["Shift"]],5:[["Ctrl"],["Win"],["Alt"],["space"],["Alt"],["Ctrl"],["inner_left"],["inner_down"],["inner_right"]]},i=localStorage.getItem("alph")?localStorage.getItem("alph"):navigator.language.slice(0,2).toLowerCase(),l="",c=!1,o=!1,u=!1,d=!1;window.addEventListener("beforeunload",(function(){return localStorage.setItem("alph",i)})),(new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.alph="ru"===i?s:r}var n,h,f;return n=e,f=[{key:"createNode",value:function(e){for(var t,n=document.createElement(e),a=arguments.length,s=new Array(a>1?a-1:0),r=1;r<a;r++)s[r-1]=arguments[r];return(t=n.classList).add.apply(t,s),n}},{key:"insertNode",value:function(e,t){var n=e;"string"==typeof t?n.textContent=t:n.append(t)}},{key:"switchLang",value:function(){document.body.innerHTML="",i="en"===i?"ru":"en",l=this.textArea.value,(new e).build()}},{key:"clickDown",value:function(t){var n,a;t.target.closest(".btn")&&(a=(n=t.target.closest(".btn")).querySelector(".btn__inner"),n.classList.add("btn_active"),this.setTextAreaValue(n,a),n.classList.contains("btn_caps")&&(d=!d,n.classList.toggle("btn_caps_active")),e.setSpecBtn(n))}},{key:"clickUp",value:function(t){var n;t.target.closest(".btn")&&((n=t.target.closest(".btn")).classList.remove("btn_active"),e.setShortcats(this),e.setSpecBtn(n))}},{key:"mouseOut",value:function(e){e.target.classList.contains("btn_active")&&!e.relatedTarget.classList.contains("btn__inner")&&e.target.closest(".btn").classList.remove("btn_active")}},{key:"pressDown",value:function(t){this.textArea.focus();var n=e.findBtn(t);if(n){n.classList.add("btn_active"),e.setSpecBtn(n,t.repeat),"Caps lock"===n.dataset.value&&(d=t.repeat?d:!d,t.repeat||n.classList.toggle("btn_caps_active"));var a=n.querySelector(".btn__inner");if(n.dataset.value.match(/^.$/)&&c)return;this.setTextAreaValue(n,a),n.dataset.value.match(/(^.$|Enter|space|Del|inner)/)&&t.preventDefault()}}},{key:"pressUp",value:function(t){var n=e.findBtn(t);e.setShortcats.bind(this)(this),e.setSpecBtn(n),n&&n.classList.remove("btn_active")}},{key:"findBtn",value:function(e){var t;return(t=e.code.includes("Arrow")?document.querySelector('[data-value="inner_'.concat(e.code.slice(5).toLowerCase(),'"]')):"ShiftLeft"===e.code?document.querySelector(".btn_lshift"):"ShiftRight"===e.code?document.querySelector(".btn_rshift"):"Space"===e.code?document.querySelector(".btn_space"):"AltLeft"===e.code?document.querySelector(".btn_lAlt"):"AltRight"===e.code?document.querySelector(".btn_rAlt"):"ControlLeft"===e.code?document.querySelector(".btn_lctrl"):"ControlRight"===e.code?document.querySelector(".btn_rctrl"):"CapsLock"===e.code?document.querySelector(".btn_caps"):"Delete"===e.code?document.querySelector(".btn_del"):"Meta"===e.key?document.querySelector(".btn_win"):"Tab"===e.key?document.querySelector(".btn_tab"):"Backspace"===e.key?document.querySelector(".btn_backspace"):'"'===e.key?document.querySelector('[data-value="dquote"]'):"IntlBackslash"===e.code?document.querySelector('[data-value="lBackSlash"]'):"Backslash"===e.code?document.querySelector('[data-value="rBackSlash"]'):(e.key.match(/^.{1}$/),document.querySelector('[data-value="'.concat(e.key,'"]'))))&&(t=t.closest(".btn")),t}},{key:"setSpecBtn",value:function(e){!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&e&&("Shift"===e.dataset.value&&(u=!!e.classList.contains("btn_active")&&!u),"Alt"===e.dataset.value&&(o=!!e.classList.contains("btn_active")&&!o),"Ctrl"===e.dataset.value&&(c=!!e.classList.contains("btn_active")&&!c))}},{key:"findBtnValue",value:function(e,t,n){var a="";return n.textContent.match(/^[^A-Za-zА-Яа-яёЁ]$/)?u&&!o?a+=t.textContent[0]:u&&o?a="":a+=n.textContent:t.className.match(/(caps|space|shift|enter|win|del|ctrl|tab|Alt)/)||n.className.match(/inner_./)?t.classList.contains("btn_tab")&&!u?a+="    ":t.classList.contains("btn_space")?a+=" ":t.classList.contains("btn_enter")&&(a+="\n"):a+=!u||o||d?!u&&d?n.textContent:u&&!o&&d?n.textContent.toLowerCase():u&&o?e.value:n.textContent.toLowerCase():n.textContent,a}},{key:"useBackspace",value:function(e,t,n,a,s){var r,i,l,o;return a?(o=e.slice(t,n),r=e.slice(0,t)+e.slice(n)):c?(l=(i=s.match(/[a-zA-ZА-Яа-я0-9ёЁ]+/)?e.slice(0,t).match(/[a-zA-ZА-Яа-я0-9ёЁ]+$/):e.slice(0,t).match(/[^a-zA-ZА-Яа-я0-9ёЁ]+$/))?0+i.index:0,o=e.slice(l,t),r=e.slice(0,l)+e.slice(n)):(o=e.slice(t-1,n),r=e.slice(0,t-1)+e.slice(n)),{newValue:r,deleted:o}}},{key:"useDel",value:function(e,t,n,a,s){var r,i,l,o;return a?(o=e.slice(t,n),r=e.slice(0,t)+e.slice(n)):c&&s?(l=(i=s.match(/[a-zA-ZА-Яа-я0-9ёЁ]+/)?e.slice(n,e.length).match(/[^a-zA-ZА-Яа-я0-9ёЁ]+?/):e.slice(n,e.length).match(/[a-zA-ZА-Яа-я0-9ёЁ]+?/))?n+i.index:e.length,o=e.slice(n,l),r=e.slice(0,n)+e.slice(l,e.length)):(o=e.slice(t,n+1),r=e.slice(0,t)+e.slice(n+1)),{newValue:r,deleted:o}}},{key:"useArrows",value:function(e,t,n,a,s,r,i){var l,o,d,h;if("inner_left"===e.dataset.value&&(c&&n>0?(l=h=(d=r.match(/[a-zA-ZА-Яа-я0-9ёЁ]+/)?t.slice(0,n).match(/[a-zA-ZА-Яа-я0-9ёЁ]+$/):t.slice(0,n).match(/[^a-zA-ZА-Яа-я0-9ёЁ]+$/))?0+d.index:0,o=u?a:h):u&&n>0?(l=n-1,o=a):u&&!n?(l=0,o=a):s?(l=n,o=n):n>0&&(l=n-1,o=n-1)),"inner_right"===e.dataset.value&&(c&&a<t.length?(o=h=(d=i.match(/[a-zA-ZА-Яа-я0-9ёЁ]+/)?t.slice(a,t.length).match(/[^a-zA-ZА-Яа-я0-9ёЁ]+?/):t.slice(a,t.length).match(/[a-zA-ZА-Яа-я0-9ёЁ]+?/))?a+d.index:t.length,l=u?n:h):u&&n<t.length?(l=n,o=a+1):u&&a===t.length?(l=n,o=t.length):s?(l=a,o=a):a<t.length?(l=n+1,o=n+1):n===t.length&&(l=t.length,o=t.length)),"inner_up"===e.dataset.value){var f=t.slice(0,n).lastIndexOf("\n");f=f<0?0:f;var v=t.slice(0,f).lastIndexOf("\n")+1,b=n-(f+1);l=f-v<b?f:v+b,o=u?a:l}if("inner_down"===e.dataset.value){var p=t.slice(0,a).lastIndexOf("\n")+1,y=t.indexOf("\n",p)+1;y=0===y?t.length:y;var m=t.slice(p,a).length;o=y===t.length?t.length:y+m,l=u?n:o}return{start:l,end:o}}},{key:"setShortcats",value:function(t){u&&o&&e.switchLang.call(t)}}],(h=[{key:"build",value:function(){this.createElements(),this.insertElements(),this.bindEvents(),this.textArea.focus()}},{key:"createButtons",value:function(){var n=this,a=[];return Object.keys(this.alph).forEach((function(s){var r=e.createNode("div","keyboard__line");n.alph[s].forEach((function(a){var i=e.createNode("div","btn__inner"),l=e.createNode("div","btn");if(a[1]){if(e.insertNode(l,a[1]),"\\"===a[0]&&1===n.alph[s].indexOf(a))l.dataset.value="lBackSlash";else if("\\"===a[0])l.dataset.value="rBackSlash";else{var c=t(a,1);l.dataset.value=c[0]}"|"===a[1]&&1===n.alph[s].indexOf(a)?i.dataset.value="l|":"|"===a[1]?i.dataset.value="r|":'"'===a[1]?i.dataset.value="dquote":i.dataset.value='"'===a[1]?"dquote":a[1]}if(a[0].length&&!a[0].match(/(inner|^space$)/)&&(a[0].length>1?e.insertNode(i,a[0]):e.insertNode(i,a[0].toUpperCase())),a[0].match(/[a-zA-ZА-Яа-яёЁ]/)&&a[0].length<=1){var o=t(a,1);l.dataset.value=o[0],i.dataset.value=a[0].toUpperCase()}else if(a[0].match(/[a-zA-ZА-Яа-яёЁ]/)){var u=t(a,1);l.dataset.value=u[0]}(a[0].length>1||a===n.alph[1][0])&&"space"!==a[0]&&l.classList.add("btn_bordered"),a[0].match(/inner/)&&i.classList.add("btn__".concat(a[0])),"Tab"===a[0]?l.classList.add("btn_tab"):"Caps lock"===a[0]?(l.classList.add("btn_caps"),d&&l.classList.add("btn_caps_active")):"Ctrl"===a[0]?n.alph[s].indexOf(a)>0?l.classList.add("btn_rctrl"):l.classList.add("btn_lctrl"):"Win"===a[0]?l.classList.add("btn_win"):"Alt"===a[0]?n.alph[s].indexOf(a)>2?l.classList.add("btn_rAlt"):l.classList.add("btn_lAlt"):"Shift"===a[0]?n.alph[s].indexOf(a)>0?l.classList.add("btn_rshift"):l.classList.add("btn_lshift"):"space"===a[0]?l.classList.add("btn_space"):"Backspace"===a[0]?l.classList.add("btn_backspace"):"Enter"===a[0]?l.classList.add("btn_enter"):"Del"===a[0]&&l.classList.add("btn_del"),e.insertNode(l,i),e.insertNode(r,l)})),a.push(r)})),a}},{key:"createElements",value:function(){this.buttons=this.createButtons(),this.main=e.createNode("main","wrapper"),this.textArea=e.createNode("textarea","wrapper__input"),this.textArea.value=l,this.keyboard=e.createNode("div","keyboard"),this.footer=e.createNode("footer","footer"),this.footerText=e.createNode("p","footer__text"),this.footerBtn=e.createNode("button","footer__btn")}},{key:"insertElements",value:function(){var t=this;this.text="en"===i?"The keyboard was created for windows. To change the language, press the button below or the key combination left shift + left alt":"Клавиатура была создана для windows. Для смены языка нажмите кнопку снизу или комбинацию клавиш левый shift + левый alt",e.insertNode(this.footerBtn,i.slice(0,1).toUpperCase()+i.slice(1)),e.insertNode(this.footerText,this.text),e.insertNode(this.footer,this.footerText),e.insertNode(this.footer,this.footerBtn),this.buttons.forEach((function(n){return e.insertNode(t.keyboard,n)})),e.insertNode(this.main,this.textArea),e.insertNode(this.main,this.keyboard),e.insertNode(document.body,this.main),e.insertNode(document.body,this.footer)}},{key:"bindEvents",value:function(){var t=e.switchLang.bind(this),n=e.clickDown.bind(this),a=e.clickUp.bind(this),s=e.mouseOut.bind(this),r=e.pressDown.bind(this),i=e.pressUp.bind(this);this.footerBtn.addEventListener("click",t),this.main.addEventListener("mousedown",n),this.main.addEventListener("mouseup",a),this.main.addEventListener("mouseout",s),this.main.addEventListener("keydown",r),this.main.addEventListener("keyup",i),this.textArea.addEventListener("focusout",(function(e){e.preventDefault(),e.target.focus()}))}},{key:"setTextAreaValue",value:function(t,n){var a,s,r,i=this.textArea.selectionStart,l=this.textArea.selectionEnd,c=this.textArea.value,o=!1,u=!1,d=l-i,h=c[i-1],f=c[l];if(t.classList.contains("btn_backspace"))0===i&&0===l||(r=e.useBackspace(c,i,l,d,h).newValue,a=e.useBackspace(c,i,l,d,h).deleted,o=!0);else if(t.classList.contains("btn_del"))r=e.useDel(c,i,l,d,f).newValue,a=e.useDel(c,i,l,d,f).deleted,u=!0;else if(t.dataset.value.includes("inner")){var v=e.useArrows(t,c,i,l,d,h,f);this.textArea.selectionStart=v.start,this.textArea.selectionEnd=v.end}else s=e.findBtnValue(this.textArea,t,n),r=c.slice(0,i)+s+c.slice(l);s?(this.textArea.value=r,this.textArea.selectionStart=i+s.length,this.textArea.selectionEnd=i+s.length):o?(this.textArea.value=r,d?(this.textArea.selectionStart=i,this.textArea.selectionEnd=i):(this.textArea.selectionStart=i-a.length,this.textArea.selectionEnd=l-a.length)):u&&(this.textArea.value=r,this.textArea.selectionStart=i,this.textArea.selectionEnd=i)}}])&&a(n.prototype,h),f&&a(n,f),Object.defineProperty(n,"prototype",{writable:!1}),e}())).build()})();